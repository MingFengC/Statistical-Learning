---
title: "Linear Regression ISLR"
author: "Chua Ming Feng"
date: "2022-09-21"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Applied Questions ISLR

## Q8a

```{r}
library(ISLR2)
library(fastDummies)
```

```{r}
y <- Auto$mpg
x <- Auto$horsepower
lm.fit <- lm(y ~ x)
summary(lm.fit)

xnew <- data.frame(x = 98)
confint(lm.fit, level = 0.95)
predict(lm.fit, newdata = xnew, interval = "prediction")
```

We observe that the p-value < 2e-16 < 0.05, thus we can reject H0 conclude that the predictor and response do have a relationship.
The relationship is strong as the p-value < 2.2e-16 < 0.05
The relationship between the predictor and response is negative

## Q8b

```{r}
plot(x, y)
abline(lm.fit)
plot(lm.fit)
```

# Q9a

```{r}
pairs(Auto)
```

## Q9b

```{r}
Auto.new <- Auto[, -ncol(Auto)]
Auto.d <- dummy_cols(Auto.new, select_columns = 'origin', remove_selected_columns = TRUE)
cor(Auto.d)
```

## Q9c

```{r}
Auto.new$origin <- as.factor(Auto.new$origin)
lm.fit <- lm(mpg ~ ., data = Auto.new)
summary(lm.fit)
```

Yes since the p-value of the F-statistic is extremely small.
Significant predictors: Displacement, weight, year and origin.
It suggests that an increase of 1 model year increases the mpg by 77700.

## Q9D

```{r}
plot(lm.fit)
```

From the residuals vs fitted plot, we observe slight non-linearity which could mean non-linearity in the data, most likely a quadratic trend. From the Q-Q plot, we observe 1 possible outlier observation 323. From the scale-location plot, we see that the variance of the residuals increases as the fitted values increases. From the leverage plot, we can see that observation 14 has significantly higher leverage than the other points.

## Q9e

```{r}
lm.fit.int <- lm(mpg ~ .^2, data = Auto.new)
summary(lm.fit.int)
```

cylinders:acceleration and acceleration:year

## Q9f

```{r}
lm.fit.log <- lm(sqrt(mpg) ~ . + I(horsepower^2), data = Auto.new)
summary(lm.fit.log)
plot(lm.fit.log)
```

We can perform a sqrt transformation on mpg to alleviate the issue where variance increases as fitted values increases. We can also apply a quadratic transformation to horsepower as there is a quadratic relationship from the scatterplot.

# Q10a










































